<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR ë³´ë¬¼ì°¾ê¸° (V4)</title>
    <style>
        body {
            font-family: "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
            text-align: center;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
            /* ìŠ¤ë§ˆíŠ¸í° í„°ì¹˜ ì‹œ í™•ëŒ€ ë°©ì§€ */
            touch-action: manipulation;
        }
        h1 {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
        }
        #instructions {
            background-color: #fff;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 0 auto 30px;
            max-width: 500px;
            font-size: 0.95rem;
            line-height: 1.6;
            color: #555;
            text-align: left;
        }

        /* ê²Œì„ ë³´ë“œíŒ (3x3) */
        #game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 400px;
            margin: 0 auto;
        }

        /* ì•„ì´í…œ ì¹¸ ìŠ¤íƒ€ì¼ */
        .item-slot {
            aspect-ratio: 1 / 1; /* ì •ì‚¬ê°í˜• ìœ ì§€ */
            background-color: #fff;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem; /* ì´ëª¨ì§€ í¬ê¸° */
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            cursor: default;
            
            /* [í•µì‹¬] ì°¾ì§€ ëª»í•œ ìƒíƒœ: í‘ë°± + íë¦¬ê²Œ */
            filter: grayscale(100%) opacity(0.3);
        }

        /* ì¤‘ì•™ ë³´ë¬¼ìƒì ì¹¸ (íŠ¹ë³„ ëŒ€ìš°) */
        #chest-slot {
            font-size: 3.5rem;
            filter: none; /* ìƒìëŠ” í•­ìƒ ì„ ëª…í•˜ê²Œ */
            opacity: 1;
        }

        /* [í•µì‹¬] ì°¾ì€ ìƒíƒœ ('found' í´ë˜ìŠ¤ ì¶”ê°€ ì‹œ) */
        .item-slot.found {
            filter: grayscale(0%) opacity(1); /* ì»¬ëŸ¬ ë³µêµ¬ */
            background-color: #e3f2fd; /* ë°°ê²½ìƒ‰ ë³€ê²½ */
            border: 2px solid #2196F3;
            animation: bounce 0.6s; /* í†µí†µ íŠ€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        }
        
        /* ë³´ë¬¼ìƒìê°€ ì—´ë ¸ì„ ë•Œ ìŠ¤íƒ€ì¼ */
        #chest-slot.open {
            background-color: #fff8e1;
            border: 2px solid #ffc107;
            animation: spin 0.6s;
        }

        /* ìŠ¹ë¦¬ ë©”ì‹œì§€ */
        #win-message {
            display: none; /* í‰ì†Œì—” ìˆ¨ê¹€ */
            margin-top: 30px;
            padding: 20px;
            background-color: #fff;
            border-radius: 12px;
            border: 2px solid #FFD700;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            animation: slideUp 0.5s ease-out;
        }
        #win-message h2 { color: #d32f2f; margin: 0 0 10px; }
        #win-message p { font-size: 1.1rem; margin: 5px 0; }
        .password { 
            font-size: 1.5rem; 
            font-weight: bold; 
            color: #1976D2; 
            background: #eee; 
            padding: 5px 15px; 
            border-radius: 8px; 
        }

        /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë“¤ */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <h1>ğŸ« ìš°ë¦¬ ë°˜ ë™ë¬¼ë†ì¥ ë³´ë¬¼ì°¾ê¸°</h1>

    <div id="instructions">
        <strong>[ì°¸ì—¬ ë°©ë²•]</strong><br>
        1. êµì‹¤ì— ìˆ¨ê²¨ì§„ <strong>QR ì½”ë“œ 8ê°œ</strong>ë¥¼ ì°¾ìœ¼ì„¸ìš”.<br>
        2. QRì„ ì°ìœ¼ë©´ ë™ë¬¼ë“¤ì´ í•˜ë‚˜ì”© ê¹¨ì–´ë‚©ë‹ˆë‹¤.<br>
        3. 8ë§ˆë¦¬ ë™ë¬¼ì„ ëª¨ë‘ ê¹¨ìš°ë©´ <strong>ë³´ë¬¼ìƒì</strong>ê°€ ì—´ë¦½ë‹ˆë‹¤!
    </div>

    <div id="game-board">
        <div class="item-slot" id="cat">ğŸ±</div>
        <div class="item-slot" id="dog">ğŸ¶</div>
        <div class="item-slot" id="rabbit">ğŸ°</div>
        
        <div class="item-slot" id="bear">ğŸ»</div>
        <div class="item-slot" id="chest-slot">ğŸ</div> <div class="item-slot" id="turtle">ğŸ¢</div>

        <div class="item-slot" id="fish">ğŸ </div>
        <div class="item-slot" id="bird">ğŸ¦</div>
        <div class="item-slot" id="butterfly">ğŸ¦‹</div>
    </div>

    <div id="win-message">
        <h2>ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
        <p>ëª¨ë“  ë™ë¬¼ ì¹œêµ¬ë“¤ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.</p>
        <p>ë³´ë¬¼ìƒìì˜ ë¹„ë°€ë²ˆí˜¸ëŠ”:</p>
        <div class="password">7 2 1 9</div>
        <p>ì„ ìƒë‹˜ê»˜ ì´ í™”ë©´ì„ ë³´ì—¬ì£¼ì„¸ìš”!</p>
    </div>

    <script>
        // 1. ì°¾ì•„ì•¼ í•  ì•„ì´í…œ ëª©ë¡ (IDì™€ ë™ì¼í•˜ê²Œ ì„¤ì •)
        const items = ['cat', 'dog', 'rabbit', 'bear', 'turtle', 'fish', 'bird', 'butterfly'];
        
        // 2. í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', () => {
            checkQRCode();    // QRë¡œ ë“¤ì–´ì™”ëŠ”ì§€ í™•ì¸
            updateBoard();    // í™”ë©´ ì—…ë°ì´íŠ¸
        });

        // 3. QR ì½”ë“œ í™•ì¸ í•¨ìˆ˜
        function checkQRCode() {
            const params = new URLSearchParams(window.location.search);
            const code = params.get('code'); // URLì—ì„œ ?code=... ê°’ ê°€ì ¸ì˜¤ê¸°

            if (code && items.includes(code)) {
                // ì €ì¥ëœ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
                let foundList = JSON.parse(localStorage.getItem('myAnimals')) || [];
                
                // ì²˜ìŒ ì°¾ì€ ë™ë¬¼ì´ë©´ ëª©ë¡ì— ì¶”ê°€
                if (!foundList.includes(code)) {
                    foundList.push(code);
                    localStorage.setItem('myAnimals', JSON.stringify(foundList));
                    alert('ì•¼í˜¸! ' + getEmoji(code) + 'ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤!');
                }
                
                // ì£¼ì†Œì°½ ê¹¨ë—í•˜ê²Œ ì •ë¦¬ (ìƒˆë¡œê³ ì¹¨ ì‹œ ì¤‘ë³µ ë°©ì§€)
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        // 4. í™”ë©´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateBoard() {
            const foundList = JSON.parse(localStorage.getItem('myAnimals')) || [];
            
            // ì°¾ì€ ë™ë¬¼ë“¤ì€ 'found' í´ë˜ìŠ¤ ì¶”ê°€ (ìƒ‰ê¹” ë‚˜íƒ€ë‚¨)
            foundList.forEach(id => {
                const element = document.getElementById(id);
                if(element) element.classList.add('found');
            });

            // 5. ìŠ¹ë¦¬ ì¡°ê±´ í™•ì¸
            if (foundList.length === items.length) {
                const chest = document.getElementById('chest-slot');
                chest.innerHTML = 'ğŸ’'; // ì—´ë¦° ìƒì(ë³´ì„)ë¡œ ë³€ê²½
                chest.classList.add('open');
                
                document.getElementById('win-message').style.display = 'block';
            }
        }

        // (ë³´ì¡°) IDì— ë§ëŠ” ì´ëª¨ì§€ ê°€ì ¸ì˜¤ê¸° (ì•Œë¦¼ì°½ìš©)
        function getEmoji(id) {
            const emojiMap = {
                'cat': 'ğŸ±', 'dog': 'ğŸ¶', 'rabbit': 'ğŸ°', 'bear': 'ğŸ»',
                'turtle': 'ğŸ¢', 'fish': 'ğŸ ', 'bird': 'ğŸ¦', 'butterfly': 'ğŸ¦‹'
            };
            return emojiMap[id] || 'ë™ë¬¼';
        }

        // í…ŒìŠ¤íŠ¸ìš© ë¦¬ì…‹ ë²„íŠ¼ (í•„ìš”ì‹œ ì½˜ì†”ì—ì„œ resetGame() ì‹¤í–‰)
        function resetGame() {
            localStorage.removeItem('myAnimals');
            location.reload();
        }
    </script>
</body>
</html>
